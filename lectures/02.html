<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Лекція 2. Моделювання загроз та оцінка ризиків — Захист ІКС</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <div class="overlay" id="overlay"></div>
    <button class="menu-toggle" id="menuToggle">☰</button>

    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html">Технології захисту ІКС</a>
        </div>
        <div class="nav-section">
            <h3>Лекції</h3>
            <ul>
                <li><a href="../lectures/01.html">1. Вступ. ІКС як об'єкт захисту</a></li>
                <li><a href="../lectures/02.html" class="active">2. Моделювання загроз</a></li>
                <li><a href="../lectures/03.html">3. Політика безпеки та доступ</a></li>
                <li><a href="../lectures/04.html">4. Криптографічний захист</a></li>
                <li><a href="../lectures/05.html">5. Захист мережевої інфраструктури</a></li>
                <li><a href="../lectures/06.html">6. Захист кінцевих точок</a></li>
                <li><a href="../lectures/07.html">7. Zero Trust та SIEM</a></li>
                <li><a href="../lectures/08.html">8. Проєктування КСЗІ</a></li>
                <li><a href="../lectures/09.html">9. Впровадження та тестування</a></li>
                <li><a href="../lectures/10.html">10. Експлуатація та інциденти</a></li>
            </ul>
        </div>
        <div class="nav-section">
            <h3>Практичні</h3>
            <ul>
                <li><a href="../practicals/01.html">1. Моделювання загроз</a></li>
                <li><a href="../practicals/02.html">2. Політика безпеки</a></li>
                <li><a href="../practicals/03.html">3. Криптографічні засоби</a></li>
                <li><a href="../practicals/04.html">4. Міжмережевий екран</a></li>
                <li><a href="../practicals/05.html">5. VPN та захист каналів</a></li>
                <li><a href="../practicals/06.html">6. IDS/IPS</a></li>
                <li><a href="../practicals/07.html">7. SIEM-системи</a></li>
                <li><a href="../practicals/08.html">8. Проєктування КСЗІ</a></li>
                <li><a href="../practicals/09.html">9. Тестування захищеності</a></li>
                <li><a href="../practicals/10.html">10. Захист проєктів</a></li>
            </ul>
        </div>
        <div class="nav-section">
            <h3>Звіти</h3>
            <ul>
                <li><a href="../report-viewer.html">Приклади звітів</a></li>
            </ul>
        </div>
    </nav>

    <main class="content">
        <article>
            <h1>Лекція 2. Моделювання загроз та оцінка ризиків</h1>
            <p class="subtitle">Методологія STRIDE, моделі порушника та інструменти аналізу загроз</p>

            <!-- ===== Розділ 1 ===== -->
            <h2>1. Класифікація загроз ІКС</h2>

            <p>Моделювання загроз починається з систематичної класифікації можливих загроз для інформаційно-комунікаційної системи. Загроза — це потенційна причина небажаного інциденту, який може завдати шкоди системі або організації. Класифікація дозволяє структурувати процес аналізу та забезпечити повноту покриття при побудові моделі загроз.</p>

            <div class="info-box">
                <strong>Визначення</strong>
                Модель загроз — це структурований опис потенційних загроз безпеці ІКС, що включає перелік загроз, їх джерела, механізми реалізації, об'єкти впливу та можливі наслідки. Модель загроз є обов'язковим документом при створенні КСЗІ згідно з НД ТЗІ 3.7-003-2005.
            </div>

            <h3>1.1. За джерелом походження</h3>

            <table>
                <thead>
                    <tr>
                        <th>Джерело</th>
                        <th>Опис</th>
                        <th>Приклади</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Природні</strong></td>
                        <td>Загрози, спричинені природними явищами, що не залежать від діяльності людини</td>
                        <td>Повені, землетруси, блискавки, пожежі природного походження, екстремальні температури</td>
                    </tr>
                    <tr>
                        <td><strong>Техногенні</strong></td>
                        <td>Загрози, пов'язані з технічними збоями, відмовами обладнання та інфраструктури</td>
                        <td>Відмова серверного обладнання, збої електроживлення, пошкодження кабельної інфраструктури, збої програмного забезпечення</td>
                    </tr>
                    <tr>
                        <td><strong>Антропогенні</strong></td>
                        <td>Загрози, спричинені навмисними або ненавмисними діями людини</td>
                        <td>Хакерські атаки, соціальна інженерія, помилки адміністраторів, інсайдерські дії, саботаж</td>
                    </tr>
                </tbody>
            </table>

            <h3>1.2. За механізмом реалізації</h3>

            <table>
                <thead>
                    <tr>
                        <th>Механізм</th>
                        <th>Опис</th>
                        <th>Приклади</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Фізичні</strong></td>
                        <td>Вплив на фізичні компоненти ІКС: обладнання, носії інформації, приміщення</td>
                        <td>Крадіжка серверів, знищення носіїв, несанкціонований фізичний доступ до серверної кімнати, підключення апаратних закладок</td>
                    </tr>
                    <tr>
                        <td><strong>Програмні</strong></td>
                        <td>Вплив через програмне забезпечення: експлуатація вразливостей, шкідливий код, маніпулювання даними</td>
                        <td>Впровадження шкідливого ПЗ, SQL-ін'єкції, переповнення буфера, атаки на протоколи автентифікації, RCE</td>
                    </tr>
                    <tr>
                        <td><strong>Організаційні</strong></td>
                        <td>Використання недоліків в організації процесів безпеки: політиках, процедурах, навчанні персоналу</td>
                        <td>Відсутність політики паролів, недостатнє навчання персоналу, порушення процедур резервного копіювання, відсутність розмежування обов'язків</td>
                    </tr>
                </tbody>
            </table>

            <h3>1.3. За наслідками для безпеки (за властивостями CIA)</h3>

            <table>
                <thead>
                    <tr>
                        <th>Порушення</th>
                        <th>Властивість CIA</th>
                        <th>Типові загрози</th>
                        <th>Наслідки</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Порушення конфіденційності</strong></td>
                        <td>Confidentiality</td>
                        <td>Перехоплення трафіку, несанкціонований доступ до БД, витік через інсайдера</td>
                        <td>Розголошення персональних даних, втрата комерційної таємниці, шантаж</td>
                    </tr>
                    <tr>
                        <td><strong>Порушення цілісності</strong></td>
                        <td>Integrity</td>
                        <td>Модифікація даних у БД, підміна конфігураційних файлів, маніпулювання журналами подій</td>
                        <td>Некоректні бізнес-рішення, неможливість розслідування інцидентів, правові наслідки</td>
                    </tr>
                    <tr>
                        <td><strong>Порушення доступності</strong></td>
                        <td>Availability</td>
                        <td>DDoS-атаки, ransomware, знищення обладнання, відключення електроживлення</td>
                        <td>Зупинка бізнес-процесів, фінансові збитки, загроза життю (для критичної інфраструктури)</td>
                    </tr>
                </tbody>
            </table>

            <div class="tip-box">
                <strong>Практична порада</strong>
                При побудові моделі загроз рекомендується використовувати всі три класифікації одночасно. Це дозволяє побудувати тривимірну матрицю загроз: для кожної загрози визначається її джерело, механізм реалізації та наслідки. Такий підхід забезпечує повноту аналізу та допомагає не пропустити важливі загрози.
            </div>

            <!-- ===== Розділ 2 ===== -->
            <h2>2. Data Flow Diagrams (DFD) — Діаграми потоків даних</h2>

            <p>Data Flow Diagram (DFD) — це графічне представлення потоків даних у системі, яке є основою для структурованого аналізу загроз. DFD дозволяє візуалізувати, як дані переміщуються між компонентами системи, де зберігаються та як обробляються. Саме на основі DFD застосовується методологія STRIDE для систематичної ідентифікації загроз.</p>

            <h3>2.1. Елементи DFD</h3>

            <table>
                <thead>
                    <tr>
                        <th>Елемент</th>
                        <th>Позначення</th>
                        <th>Опис</th>
                        <th>Приклад</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Процес (Process)</strong></td>
                        <td>Коло або округлений прямокутник</td>
                        <td>Компонент, що обробляє або трансформує дані. Може бути додатком, сервісом, функцією</td>
                        <td>Веб-сервер, служба автентифікації, API-шлюз, обробник платежів</td>
                    </tr>
                    <tr>
                        <td><strong>Сховище даних (Data Store)</strong></td>
                        <td>Дві горизонтальні лінії</td>
                        <td>Місце зберігання даних: база даних, файлова система, кеш, черга повідомлень</td>
                        <td>База даних користувачів, лог-файли, сховище сертифікатів, Redis-кеш</td>
                    </tr>
                    <tr>
                        <td><strong>Потік даних (Data Flow)</strong></td>
                        <td>Стрілка</td>
                        <td>Переміщення даних між елементами. Позначається стрілкою з описом даних, що передаються</td>
                        <td>HTTP-запит, SQL-запит, API-виклик, LDAP-запит, передача файлів</td>
                    </tr>
                    <tr>
                        <td><strong>Зовнішня сутність (External Entity)</strong></td>
                        <td>Прямокутник</td>
                        <td>Суб'єкт або система, що знаходиться за межами аналізованої системи, але взаємодіє з нею</td>
                        <td>Користувач, зовнішній API, партнерська система, поштовий сервер провайдера</td>
                    </tr>
                    <tr>
                        <td><strong>Межа довіри (Trust Boundary)</strong></td>
                        <td>Пунктирна лінія</td>
                        <td>Розділяє зони з різним рівнем довіри. Потоки даних, що перетинають межі довіри, є найбільш критичними з точки зору безпеки</td>
                        <td>Межа між Інтернетом та DMZ, між DMZ та LAN, між корпоративною мережею та хмарою</td>
                    </tr>
                </tbody>
            </table>

            <div class="warning-box">
                <strong>Ключовий принцип</strong>
                Потоки даних, що перетинають межі довіри (trust boundaries), є пріоритетними об'єктами аналізу загроз. Саме на цих межах найчастіше виникають вразливості: недостатня автентифікація, відсутність шифрування, неналежна валідація вхідних даних.
            </div>

            <h3>2.2. Рівні деталізації DFD</h3>

            <p>DFD будується ієрархічно, від загального огляду до детального представлення окремих компонентів:</p>

            <ul>
                <li><strong>Контекстний рівень (L0)</strong> — показує систему як один процес, що взаємодіє із зовнішніми сутностями. Дає загальне уявлення про межі системи та її зовнішні інтерфейси. На цьому рівні видно, хто взаємодіє з системою та які дані надходять / виходять.</li>
                <li><strong>Рівень 1 (L1)</strong> — декомпозиція системи на основні підсистеми (процеси). Показує внутрішні сховища даних та потоки між підсистемами. Визначаються основні межі довіри. Це найважливіший рівень для моделювання загроз.</li>
                <li><strong>Рівень 2 (L2)</strong> — детальна декомпозиція окремих підсистем рівня L1. Показує конкретні компоненти, їх взаємодію та деталі обробки даних. Використовується для глибокого аналізу критичних підсистем.</li>
            </ul>

            <h3>2.3. Правила побудови DFD</h3>
            <ol>
                <li>Кожен процес повинен мати хоча б один вхідний та один вихідний потік даних</li>
                <li>Потоки даних не можуть з'єднувати два сховища безпосередньо — між ними повинен бути процес</li>
                <li>Потоки не можуть з'єднувати дві зовнішні сутності безпосередньо — це поза межами системи</li>
                <li>Кожен елемент повинен мати унікальне ім'я та ідентифікатор</li>
                <li>Межі довіри позначаються скрізь, де змінюється рівень довіри або привілеїв</li>
                <li>Підписуйте потоки даних — вказуйте тип даних, що передаються (облікові дані, персональні дані, команди управління)</li>
            </ol>

            <div class="example-box">
                <strong>Приклад побудови DFD для веб-додатку (L1)</strong>
                Зовнішні сутності: Користувач (браузер), Зовнішній платіжний сервіс. Процеси: Веб-сервер (Nginx), Сервер додатків (Django), Служба автентифікації. Сховища: БД PostgreSQL, Redis-кеш, Лог-файли. Межі довіри: Інтернет | DMZ (Nginx) | LAN (Django, БД). Потоки: HTTPS (Користувач → Nginx), HTTP (Nginx → Django), SQL (Django → PostgreSQL), API-запит (Django → Платіжний сервіс).
            </div>

            <!-- ===== Розділ 3 ===== -->
            <h2>3. Методологія STRIDE</h2>

            <p>STRIDE — це методологія моделювання загроз, розроблена компанією Microsoft у 1999 році. Назва є акронімом шести категорій загроз. STRIDE застосовується до кожного елемента DFD для систематичної ідентифікації потенційних загроз. Методологія широко використовується у промисловості та є основою інструменту <code>Microsoft Threat Modeling Tool</code>.</p>

            <h3>3.1. Шість категорій загроз STRIDE</h3>

            <h4>S — Spoofing (Підміна ідентичності)</h4>
            <p>Зловмисник видає себе за іншого користувача, процес або систему, щоб отримати несанкціонований доступ. Порушує властивість <strong>автентичності</strong>.</p>
            <ul>
                <li>Крадіжка облікових даних (логін/пароль) через фішинг або brute-force</li>
                <li>Підміна IP-адреси (IP spoofing) або MAC-адреси (MAC spoofing)</li>
                <li>Використання викрадених сесійних токенів або cookies</li>
                <li>ARP spoofing для перехоплення трафіку в локальній мережі</li>
                <li>Підроблення сертифікатів або DNS-записів</li>
            </ul>

            <h4>T — Tampering (Підробка даних)</h4>
            <p>Несанкціонована модифікація даних під час передачі або зберігання. Порушує властивість <strong>цілісності</strong>.</p>
            <ul>
                <li>Модифікація даних у базі через SQL-ін'єкцію</li>
                <li>Зміна конфігураційних файлів системи</li>
                <li>Перехоплення та модифікація мережевого трафіку (man-in-the-middle)</li>
                <li>Підміна оновлень програмного забезпечення (supply chain attack)</li>
                <li>Модифікація журналів подій для приховування слідів атаки</li>
            </ul>

            <h4>R — Repudiation (Відмова від авторства)</h4>
            <p>Користувач або система заперечує виконання певної дії за відсутності механізмів підтвердження авторства. Порушує властивість <strong>неспростовності</strong>.</p>
            <ul>
                <li>Користувач заперечує виконання фінансової транзакції</li>
                <li>Адміністратор заперечує зміну конфігурації, що спричинила інцидент</li>
                <li>Відсутність або неповнота журналів аудиту</li>
                <li>Можливість модифікації лог-файлів після факту</li>
            </ul>

            <h4>I — Information Disclosure (Розголошення інформації)</h4>
            <p>Несанкціонований доступ до конфіденційної інформації. Порушує властивість <strong>конфіденційності</strong>.</p>
            <ul>
                <li>Перехоплення незашифрованого мережевого трафіку (sniffing)</li>
                <li>Доступ до незахищених резервних копій або лог-файлів</li>
                <li>Витік інформації через повідомлення про помилки (error messages)</li>
                <li>Несанкціонований доступ до бази даних через неналежне розмежування прав</li>
                <li>Побічні канали (side-channel attacks): тайминг-атаки, аналіз електромагнітного випромінювання</li>
            </ul>

            <h4>D — Denial of Service (Відмова в обслуговуванні)</h4>
            <p>Порушення доступності системи або окремих її сервісів для легітимних користувачів. Порушує властивість <strong>доступності</strong>.</p>
            <ul>
                <li>DDoS-атаки: volumetric (UDP flood), protocol (SYN flood), application layer (HTTP flood)</li>
                <li>Вичерпання ресурсів сервера (CPU, RAM, дисковий простір)</li>
                <li>Блокування облікових записів через масовий перебір паролів</li>
                <li>Ransomware — шифрування даних з вимогою викупу</li>
                <li>Фізичне знищення або пошкодження обладнання</li>
            </ul>

            <h4>E — Elevation of Privilege (Підвищення привілеїв)</h4>
            <p>Зловмисник отримує права, що перевищують його авторизований рівень доступу. Порушує властивість <strong>авторизації</strong>.</p>
            <ul>
                <li>Експлуатація вразливостей ядра ОС для отримання root-прав</li>
                <li>SQL-ін'єкція для виконання команд від імені адміністратора БД</li>
                <li>Переповнення буфера для виконання довільного коду</li>
                <li>Використання неправильно налаштованих SUID/SGID-бітів у Linux</li>
                <li>Горизонтальне підвищення привілеїв: доступ до ресурсів інших користувачів того ж рівня (IDOR)</li>
            </ul>

            <h3>3.2. Відповідність STRIDE до властивостей безпеки</h3>

            <table>
                <thead>
                    <tr>
                        <th>Загроза STRIDE</th>
                        <th>Порушена властивість</th>
                        <th>Типовий захист</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Spoofing</strong></td>
                        <td>Автентичність (Authentication)</td>
                        <td>MFA, сертифікати X.509, Kerberos, біометрія, SPF/DKIM/DMARC</td>
                    </tr>
                    <tr>
                        <td><strong>Tampering</strong></td>
                        <td>Цілісність (Integrity)</td>
                        <td>Хеш-функції (SHA-256), ЕЦП, TLS, контроль цілісності файлів (<code>AIDE</code>, <code>Tripwire</code>)</td>
                    </tr>
                    <tr>
                        <td><strong>Repudiation</strong></td>
                        <td>Неспростовність (Non-repudiation)</td>
                        <td>Аудит-логи (append-only), ЕЦП (КЕП), SIEM, NTP-синхронізація часу</td>
                    </tr>
                    <tr>
                        <td><strong>Information Disclosure</strong></td>
                        <td>Конфіденційність (Confidentiality)</td>
                        <td>Шифрування (AES-256, TLS 1.3), DLP-системи, управління доступом (RBAC)</td>
                    </tr>
                    <tr>
                        <td><strong>Denial of Service</strong></td>
                        <td>Доступність (Availability)</td>
                        <td>Rate limiting, CDN, балансування навантаження, резервування, anti-DDoS</td>
                    </tr>
                    <tr>
                        <td><strong>Elevation of Privilege</strong></td>
                        <td>Авторизація (Authorization)</td>
                        <td>Мінімальні привілеї (Least Privilege), RBAC, sandboxing, оновлення ПЗ, PAM</td>
                    </tr>
                </tbody>
            </table>

            <h3>3.3. Застосування STRIDE до елементів DFD</h3>

            <p>Не всі категорії STRIDE застосовуються до кожного елемента DFD. Наступна таблиця показує, які загрози є релевантними для кожного типу елемента:</p>

            <table>
                <thead>
                    <tr>
                        <th>Елемент DFD</th>
                        <th>S</th>
                        <th>T</th>
                        <th>R</th>
                        <th>I</th>
                        <th>D</th>
                        <th>E</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Зовнішня сутність</strong></td>
                        <td>+</td>
                        <td></td>
                        <td>+</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><strong>Процес</strong></td>
                        <td>+</td>
                        <td>+</td>
                        <td>+</td>
                        <td>+</td>
                        <td>+</td>
                        <td>+</td>
                    </tr>
                    <tr>
                        <td><strong>Потік даних</strong></td>
                        <td></td>
                        <td>+</td>
                        <td></td>
                        <td>+</td>
                        <td>+</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><strong>Сховище даних</strong></td>
                        <td></td>
                        <td>+</td>
                        <td>+</td>
                        <td>+</td>
                        <td>+</td>
                        <td></td>
                    </tr>
                </tbody>
            </table>

            <div class="info-box">
                <strong>Як читати таблицю</strong>
                Знак «+» означає, що відповідна категорія загрози застосовна до елемента DFD. Наприклад, для <strong>процесу</strong> застосовні всі шість категорій STRIDE (він є найбільш вразливим елементом), тоді як для <strong>потоку даних</strong> — лише Tampering, Information Disclosure та Denial of Service.
            </div>

            <h3>3.4. Процес застосування STRIDE</h3>
            <ol>
                <li><strong>Побудувати DFD</strong> — визначити процеси, сховища даних, потоки даних, зовнішні сутності та межі довіри</li>
                <li><strong>Пронумерувати елементи</strong> — кожному елементу DFD присвоїти унікальний ідентифікатор (P1, D1, E1, F1)</li>
                <li><strong>Для кожного елемента</strong> — визначити застосовні категорії STRIDE згідно з таблицею відповідності</li>
                <li><strong>Для кожної категорії</strong> — сформулювати конкретні загрози, специфічні для даного елемента та контексту системи</li>
                <li><strong>Оцінити ризик</strong> — визначити ймовірність та вплив кожної загрози</li>
                <li><strong>Визначити контрзаходи</strong> — для кожної загрози визначити технічні або організаційні заходи протидії</li>
                <li><strong>Задокументувати</strong> — оформити модель загроз як формальний документ</li>
            </ol>

            <div class="tip-box">
                <strong>Методика аналізу</strong>
                Для кожного елемента DFD перевірте всі відповідні категорії STRIDE. Запишіть конкретні загрози, їх можливі сценарії реалізації та запропонуйте контрзаходи. Почніть з потоків даних, що перетинають межі довіри — вони є найбільш критичними.
            </div>

            <!-- ===== Розділ 4 ===== -->
            <h2>4. Моделі порушника</h2>

            <p>Модель порушника — це формалізований опис потенційного суб'єкта загрози: його можливостей, мотивації, ресурсів та методів дій. Побудова моделі порушника є обов'язковим елементом моделювання загроз та визначає, від кого ми захищаємо ІКС. Згідно з НД ТЗІ, модель порушника розробляється на етапі передпроєктного обстеження.</p>

            <h3>4.1. Класифікація за відношенням до системи</h3>

            <table>
                <thead>
                    <tr>
                        <th>Тип порушника</th>
                        <th>Характеристика</th>
                        <th>Приклади</th>
                        <th>Типові дії</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Зовнішній</strong></td>
                        <td>Не має легітимного доступу до ІКС. Діє ззовні периметра мережі. Не має інсайдерської інформації про архітектуру.</td>
                        <td>Хакери, організовані злочинні групи, конкуренти, державні актори (APT-групи), хактивісти</td>
                        <td>Сканування вразливостей, фішинг, DDoS, brute-force, експлуатація вразливостей публічних сервісів</td>
                    </tr>
                    <tr>
                        <td><strong>Внутрішній</strong></td>
                        <td>Має легітимний доступ до ІКС (повний або частковий). Знаходиться «всередині» периметра. Знає внутрішню архітектуру.</td>
                        <td>Незадоволені працівники, підкуплений персонал, недбалі адміністратори, підрядники з доступом до систем</td>
                        <td>Крадіжка даних, саботаж, встановлення backdoor, зловживання привілеями, недбале поводження з даними</td>
                    </tr>
                </tbody>
            </table>

            <h3>4.2. Чотири рівні можливостей порушника</h3>

            <p>Рівні визначають технічні спроможності порушника та його ресурси згідно з НД ТЗІ 2.5-004-99. Чим вищий рівень, тим складніші атаки може здійснити порушник і тим серйозніші заходи захисту необхідні:</p>

            <table>
                <thead>
                    <tr>
                        <th>Рівень</th>
                        <th>Опис можливостей</th>
                        <th>Типовий профіль</th>
                        <th>Приклади атак</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Рівень 1 (Низький)</strong></td>
                        <td>Базові знання ІТ. Використовує готові інструменти та скрипти без глибокого розуміння їх роботи. Обмежені ресурси. Можливість запуску програм з фіксованого набору.</td>
                        <td>«Script kiddie», недосвідчений інсайдер, випадковий зловмисник</td>
                        <td>Використання готових експлойтів з Metasploit, прості фішингові атаки, перебір паролів</td>
                    </tr>
                    <tr>
                        <td><strong>Рівень 2 (Середній)</strong></td>
                        <td>Хороші знання ОС, мереж та програмування. Може модифікувати існуючі інструменти та адаптувати атаки. Створення та запуск власних програм. Певні фінансові ресурси.</td>
                        <td>Кваліфікований хакер, досвідчений адміністратор, фрілансер-зловмисник</td>
                        <td>Написання власних скриптів, обхід простих засобів захисту, соціальна інженерія середньої складності</td>
                    </tr>
                    <tr>
                        <td><strong>Рівень 3 (Високий)</strong></td>
                        <td>Глибокі знання архітектури ІКС, вразливостей та методів захисту. Може розробляти складне шкідливе ПЗ. Управління функціонуванням ІКС. Доступ до засобів захисту. Значні ресурси.</td>
                        <td>Організована злочинна група, професійна хакерська група, адміністратор безпеки</td>
                        <td>Розробка цільового шкідливого ПЗ, складні атаки з використанням ланцюга вразливостей, атаки на ланцюг постачання</td>
                    </tr>
                    <tr>
                        <td><strong>Рівень 4 (Критичний)</strong></td>
                        <td>Необмежені ресурси. Доступ до zero-day вразливостей. Можливість тривалих цілеспрямованих операцій. Повний обсяг можливостей, включаючи проєктування та модифікацію апаратних і програмних засобів.</td>
                        <td>Державні спецслужби, APT-групи (APT28, APT29, Lazarus Group, Sandworm)</td>
                        <td>APT-атаки тривалістю місяці/роки, supply chain attacks, розробка zero-day експлойтів, атаки на firmware</td>
                    </tr>
                </tbody>
            </table>

            <h3>4.3. Мотивація порушника</h3>

            <table>
                <thead>
                    <tr>
                        <th>Мотивація</th>
                        <th>Опис</th>
                        <th>Типовий порушник</th>
                        <th>Цільові активи</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Фінансова</strong></td>
                        <td>Отримання прямого або непрямого прибутку від атаки: крадіжка коштів, продаж викрадених даних, вимагання викупу</td>
                        <td>Кіберзлочинці, ransomware-групи</td>
                        <td>Фінансові дані, персональні дані, облікові записи, криптовалюта</td>
                    </tr>
                    <tr>
                        <td><strong>Ідеологічна</strong></td>
                        <td>Просування політичних, соціальних або релігійних ідей через кібератаки; протест проти дій організації чи держави</td>
                        <td>Хактивісти (Anonymous), радикальні угруповання</td>
                        <td>Веб-сайти (defacement), бази даних (витік для розголосу), інфраструктура</td>
                    </tr>
                    <tr>
                        <td><strong>Конкурентна</strong></td>
                        <td>Отримання конкурентної переваги через крадіжку інтелектуальної власності, технологій, клієнтських баз або комерційних таємниць</td>
                        <td>Конкурентна розвідка, державне промислове шпигунство</td>
                        <td>Інтелектуальна власність, R&amp;D-дані, стратегічні плани, клієнтські бази</td>
                    </tr>
                    <tr>
                        <td><strong>Помста</strong></td>
                        <td>Нанесення шкоди організації через особисту образу, звільнення, конфлікт. Часто найнебезпечніша мотивація у поєднанні з інсайдерським доступом.</td>
                        <td>Звільнені працівники, незадоволені підрядники</td>
                        <td>Критичні системи, дані, репутація організації</td>
                    </tr>
                </tbody>
            </table>

            <div class="warning-box">
                <strong>Важливо</strong>
                Модель порушника повинна бути реалістичною та відповідати контексту організації. Для невеликої компанії моделювання загроз від APT-групи рівня 4 може бути надлишковим, тоді як для об'єкта критичної інфраструктури — обов'язковим. Правильне визначення рівня порушника дозволяє раціонально розподілити ресурси на захист.
            </div>

            <!-- ===== Розділ 5 ===== -->
            <h2>5. Оцінка ризиків</h2>

            <p>Оцінка ризиків — це процес визначення ймовірності реалізації загрози та потенційного впливу (збитків) у разі її реалізації. Результати оцінки ризиків використовуються для пріоритезації заходів захисту та раціонального розподілу ресурсів. Існують два основні підходи: якісний та кількісний.</p>

            <h3>5.1. Якісна оцінка ризиків: матриця 5x5</h3>

            <p>Якісний метод базується на експертних оцінках ймовірності та впливу за шкалою від 1 до 5. Ризик визначається як добуток ймовірності та впливу.</p>

            <h4>Шкала ймовірності</h4>
            <table>
                <thead>
                    <tr>
                        <th>Бал</th>
                        <th>Рівень</th>
                        <th>Опис</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>Дуже низька</td>
                        <td>Малоймовірно; може статися лише за виняткових обставин</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Низька</td>
                        <td>Малоймовірно, але можливо; траплялося у галузі</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Середня</td>
                        <td>Можливо; є відомі прецеденти; відбувається періодично</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>Висока</td>
                        <td>Ймовірно; очікується реалізація протягом року</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>Дуже висока</td>
                        <td>Майже гарантовано; реалізується регулярно або неминуче</td>
                    </tr>
                </tbody>
            </table>

            <h4>Шкала впливу</h4>
            <table>
                <thead>
                    <tr>
                        <th>Бал</th>
                        <th>Рівень</th>
                        <th>Опис</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>Незначний</td>
                        <td>Мінімальний вплив; швидке відновлення; незначні фінансові втрати</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Низький</td>
                        <td>Обмежений вплив на окремий процес; помірні витрати на відновлення</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Середній</td>
                        <td>Суттєвий вплив на бізнес-процеси; значні фінансові втрати; юридичні наслідки</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>Високий</td>
                        <td>Критичний вплив; тривалий простій; серйозні репутаційні збитки</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>Катастрофічний</td>
                        <td>Загроза існуванню організації; загроза життю; неможливість відновлення</td>
                    </tr>
                </tbody>
            </table>

            <h4>Матриця ризиків 5x5 (Ймовірність x Вплив)</h4>
            <table>
                <thead>
                    <tr>
                        <th>Ймовірність \ Вплив</th>
                        <th>1 (Незначний)</th>
                        <th>2 (Низький)</th>
                        <th>3 (Середній)</th>
                        <th>4 (Високий)</th>
                        <th>5 (Катастрофічний)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>5 (Дуже висока)</strong></td>
                        <td style="background:#fef9c3;">5 — Середній</td>
                        <td style="background:#fed7aa;">10 — Високий</td>
                        <td style="background:#fca5a5;">15 — Критичний</td>
                        <td style="background:#fca5a5;">20 — Критичний</td>
                        <td style="background:#fca5a5;">25 — Критичний</td>
                    </tr>
                    <tr>
                        <td><strong>4 (Висока)</strong></td>
                        <td style="background:#d1fae5;">4 — Низький</td>
                        <td style="background:#fef9c3;">8 — Середній</td>
                        <td style="background:#fed7aa;">12 — Високий</td>
                        <td style="background:#fca5a5;">16 — Критичний</td>
                        <td style="background:#fca5a5;">20 — Критичний</td>
                    </tr>
                    <tr>
                        <td><strong>3 (Середня)</strong></td>
                        <td style="background:#d1fae5;">3 — Низький</td>
                        <td style="background:#fef9c3;">6 — Середній</td>
                        <td style="background:#fef9c3;">9 — Середній</td>
                        <td style="background:#fed7aa;">12 — Високий</td>
                        <td style="background:#fca5a5;">15 — Критичний</td>
                    </tr>
                    <tr>
                        <td><strong>2 (Низька)</strong></td>
                        <td style="background:#d1fae5;">2 — Низький</td>
                        <td style="background:#d1fae5;">4 — Низький</td>
                        <td style="background:#fef9c3;">6 — Середній</td>
                        <td style="background:#fef9c3;">8 — Середній</td>
                        <td style="background:#fed7aa;">10 — Високий</td>
                    </tr>
                    <tr>
                        <td><strong>1 (Дуже низька)</strong></td>
                        <td style="background:#d1fae5;">1 — Низький</td>
                        <td style="background:#d1fae5;">2 — Низький</td>
                        <td style="background:#d1fae5;">3 — Низький</td>
                        <td style="background:#d1fae5;">4 — Низький</td>
                        <td style="background:#fef9c3;">5 — Середній</td>
                    </tr>
                </tbody>
            </table>

            <div class="info-box">
                <strong>Інтерпретація рівнів ризику</strong>
                <strong>Критичний (15–25):</strong> потребує негайних заходів; ризик неприйнятний, необхідно впровадити контрзаходи до початку експлуатації системи.<br>
                <strong>Високий (10–14):</strong> потребує пріоритетної уваги; план зниження ризику з конкретними термінами.<br>
                <strong>Середній (5–9):</strong> потребує планових заходів; включити у план управління ризиками.<br>
                <strong>Низький (1–4):</strong> прийнятний ризик; моніторинг та контроль.
            </div>

            <h3>5.2. Кількісна оцінка ризиків</h3>

            <p>Кількісний метод використовує грошові показники для оцінки ризиків, що дозволяє обґрунтувати інвестиції у безпеку перед керівництвом.</p>

            <h4>Основні показники</h4>
            <ul>
                <li><strong>AV (Asset Value)</strong> — вартість активу (грошовий еквівалент)</li>
                <li><strong>EF (Exposure Factor)</strong> — фактор впливу: відсоток вартості активу, що буде втрачений при реалізації загрози (0–100%)</li>
                <li><strong>SLE (Single Loss Expectancy)</strong> — очікувані втрати від одного інциденту: <code>SLE = AV × EF</code></li>
                <li><strong>ARO (Annualized Rate of Occurrence)</strong> — очікувана кількість реалізацій загрози на рік</li>
                <li><strong>ALE (Annualized Loss Expectancy)</strong> — річні очікувані втрати: <code>ALE = SLE × ARO</code></li>
            </ul>

            <div class="example-box">
                <strong>Приклад кількісної оцінки</strong>
                Актив: сервер бази даних клієнтів. AV = 500 000 грн (вартість сервера + дані + репутаційні збитки). Загроза: ransomware-атака. EF = 60% (60% вартості буде втрачено при успішній атаці). SLE = 500 000 × 0.6 = 300 000 грн. ARO = 0.5 (очікуємо одну атаку раз на 2 роки). <strong>ALE = 300 000 × 0.5 = 150 000 грн/рік.</strong> Висновок: витрати на захист від ransomware до 150 000 грн/рік є економічно обґрунтованими.
            </div>

            <h3>5.3. Метод DREAD</h3>

            <p>DREAD — це метод оцінки ризиків, що оцінює загрози за п'ятьма критеріями за шкалою від 1 до 10. Розроблений Microsoft як доповнення до STRIDE.</p>

            <table>
                <thead>
                    <tr>
                        <th>Критерій</th>
                        <th>Опис</th>
                        <th>Низький бал (1–3)</th>
                        <th>Високий бал (8–10)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>D — Damage (Збитки)</strong></td>
                        <td>Наскільки серйозними будуть збитки від реалізації загрози?</td>
                        <td>Незначний вплив, легке відновлення</td>
                        <td>Повна компрометація системи, загроза життю</td>
                    </tr>
                    <tr>
                        <td><strong>R — Reproducibility (Відтворюваність)</strong></td>
                        <td>Наскільки легко відтворити атаку?</td>
                        <td>Потребує специфічних умов, важко відтворити</td>
                        <td>Легко відтворити у будь-який час</td>
                    </tr>
                    <tr>
                        <td><strong>E — Exploitability (Експлуатованість)</strong></td>
                        <td>Наскільки легко здійснити атаку?</td>
                        <td>Потребує глибоких знань та спеціальних інструментів</td>
                        <td>Доступний готовий експлойт, мінімальні навички</td>
                    </tr>
                    <tr>
                        <td><strong>A — Affected Users (Масштаб)</strong></td>
                        <td>Скільки користувачів постраждає?</td>
                        <td>Один користувач або невелика група</td>
                        <td>Всі користувачі системи</td>
                    </tr>
                    <tr>
                        <td><strong>D — Discoverability (Виявлюваність)</strong></td>
                        <td>Наскільки легко виявити вразливість?</td>
                        <td>Важко виявити; потребує вихідного коду</td>
                        <td>Легко виявити; публічно відома інформація</td>
                    </tr>
                </tbody>
            </table>

            <p>Загальний бал DREAD обчислюється як середнє арифметичне п'яти критеріїв: <code>DREAD = (D + R + E + A + D) / 5</code>. Результат від 1 до 10 дозволяє ранжувати загрози за пріоритетом.</p>

            <h3>5.4. Стратегії обробки ризиків</h3>
            <p>Після оцінки ризиків для кожного з них обирається стратегія обробки:</p>
            <ul>
                <li><strong>Зниження (Mitigation)</strong> — впровадження контрзаходів для зменшення ймовірності або впливу (найбільш поширена стратегія)</li>
                <li><strong>Передача (Transfer)</strong> — передача ризику третій стороні, наприклад, через кіберстрахування або аутсорсинг</li>
                <li><strong>Уникнення (Avoidance)</strong> — відмова від діяльності, що створює ризик (наприклад, відмова від зберігання певних даних)</li>
                <li><strong>Прийняття (Acceptance)</strong> — свідоме прийняття ризику, якщо вартість контрзаходів перевищує потенційний збиток</li>
            </ul>

            <div class="tip-box">
                <strong>Порівняння методів оцінки ризиків</strong>
                Якісна оцінка (матриця 5x5) — проста у застосуванні, не потребує точних числових даних, підходить для початкового аналізу. Кількісна оцінка (ALE) — дає конкретні грошові показники, обґрунтовує інвестиції, але потребує достовірних статистичних даних. DREAD — компроміс, що дає числову оцінку без необхідності фінансових розрахунків. На практиці рекомендується комбінувати підходи: якісний — для швидкої пріоритезації, кількісний — для обґрунтування бюджету перед керівництвом.
            </div>

            <!-- ===== Розділ 6 ===== -->
            <h2>6. Інструменти моделювання загроз</h2>

            <p>Сучасне моделювання загроз підтримується спеціалізованими інструментами, які автоматизують побудову DFD, ідентифікацію загроз та генерацію звітів. Розглянемо найважливіші з них.</p>

            <h3>6.1. Microsoft Threat Modeling Tool</h3>

            <p><code>Microsoft Threat Modeling Tool</code> — безкоштовний інструмент від Microsoft для побудови моделей загроз на основі DFD та методології STRIDE. Є одним з найпопулярніших інструментів для моделювання загроз у промисловості.</p>

            <h4>Основні можливості</h4>
            <ul>
                <li><strong>Візуальне створення DFD</strong> — графічний редактор з елементами: процеси, сховища, потоки, зовнішні сутності, межі довіри</li>
                <li><strong>Автоматичний аналіз за STRIDE</strong> — після побудови DFD інструмент автоматично генерує перелік потенційних загроз для кожного елемента</li>
                <li><strong>Шаблони</strong> — готові шаблони для різних типів систем (веб-додатки, Azure-сервіси, IoT, Generic)</li>
                <li><strong>Управління загрозами</strong> — кожну загрозу можна позначити як: needs investigation, mitigated, not applicable</li>
                <li><strong>Генерація звітів</strong> — автоматичне створення звіту (HTML/CSV) з переліком загроз, їх статусом та рекомендованими контрзаходами</li>
            </ul>

            <div class="example-box">
                <strong>Робочий процес у Microsoft Threat Modeling Tool</strong>
                1. Створити нову модель, обрати шаблон (наприклад, «Azure Threat Model» або «Generic»).<br>
                2. Побудувати DFD: додати зовнішні сутності, процеси, сховища, потоки даних.<br>
                3. Визначити межі довіри (trust boundaries) між різними зонами безпеки.<br>
                4. Перейти до «Analysis View» — інструмент автоматично згенерує перелік загроз за STRIDE.<br>
                5. Для кожної загрози вказати статус та контрзаходи.<br>
                6. Згенерувати звіт для документації.
            </div>

            <div class="tip-box">
                <strong>Практична порада</strong>
                Microsoft Threat Modeling Tool генерує десятки загроз навіть для простої DFD. Не намагайтеся обробити всі загрози за один підхід. Почніть з тих, що перетинають межі довіри — це найбільш критичні точки. Позначте нерелевантні загрози як «Not Applicable» з поясненням.
            </div>

            <h3>6.2. OWASP Threat Dragon</h3>

            <p><code>OWASP Threat Dragon</code> — безкоштовний open-source інструмент для моделювання загроз від спільноти OWASP (Open Web Application Security Project).</p>

            <h4>Ключові особливості</h4>
            <ul>
                <li><strong>Веб-версія та десктопна версія</strong> — працює у браузері або як автономний додаток (Electron)</li>
                <li><strong>Інтеграція з GitHub</strong> — моделі загроз зберігаються у Git-репозиторії як JSON-файли, що дозволяє версіонувати моделі разом із кодом</li>
                <li><strong>Побудова DFD</strong> — візуальний редактор для створення діаграм потоків даних</li>
                <li><strong>Ручне додавання загроз</strong> — на відміну від Microsoft TMT, загрози додаються вручну, що забезпечує більш глибокий та осмислений аналіз</li>
                <li><strong>Підтримка STRIDE та LINDDUN</strong> — для аналізу загроз безпеки та приватності</li>
                <li><strong>Крос-платформеність</strong> — працює на Windows, Linux, macOS</li>
                <li><strong>Відкритий вихідний код</strong> — можливість розширення та адаптації під потреби організації</li>
            </ul>

            <h4>Встановлення та запуск</h4>
<pre><code># Встановлення десктопної версії через npm
npm install -g owasp-threat-dragon

# Або завантаження готового інсталятора з GitHub:
# https://github.com/OWASP/threat-dragon/releases

# Запуск веб-версії локально через Docker:
docker run -p 3000:3000 owasp/threat-dragon:latest</code></pre>

            <h3>6.3. MITRE ATT&amp;CK</h3>

            <p><code>MITRE ATT&amp;CK</code> (Adversarial Tactics, Techniques, and Common Knowledge) — це глобально доступна база знань про тактики та техніки кіберзловмисників, побудована на основі реальних спостережень за атаками. ATT&amp;CK не є інструментом моделювання загроз у традиційному розумінні, але є незамінним ресурсом для збагачення моделі загроз реалістичними сценаріями атак.</p>

            <h4>Структура MITRE ATT&amp;CK</h4>

            <table>
                <thead>
                    <tr>
                        <th>Рівень</th>
                        <th>Опис</th>
                        <th>Кількість (Enterprise)</th>
                        <th>Приклади</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Тактики (Tactics)</strong></td>
                        <td>Високорівневі цілі зловмисника — «чому» він виконує дію. Представлені як стовпці матриці.</td>
                        <td>14 тактик</td>
                        <td>Initial Access, Execution, Persistence, Privilege Escalation, Defense Evasion, Credential Access, Discovery, Lateral Movement, Collection, Exfiltration, Impact</td>
                    </tr>
                    <tr>
                        <td><strong>Техніки (Techniques)</strong></td>
                        <td>Методи досягнення тактичних цілей — «як» зловмисник виконує дію. Кожна техніка прив'язана до однієї або кількох тактик.</td>
                        <td>~200 технік</td>
                        <td>Phishing (T1566), Valid Accounts (T1078), OS Credential Dumping (T1003), Remote Services (T1021)</td>
                    </tr>
                    <tr>
                        <td><strong>Підтехніки (Sub-techniques)</strong></td>
                        <td>Більш детальний опис конкретних варіантів реалізації техніки.</td>
                        <td>~400 підтехнік</td>
                        <td>Phishing: Spearphishing Attachment (T1566.001), Phishing: Spearphishing Link (T1566.002), Phishing: Spearphishing via Service (T1566.003)</td>
                    </tr>
                </tbody>
            </table>

            <h4>14 тактик ATT&amp;CK Enterprise</h4>
            <ol>
                <li><strong>Reconnaissance</strong> — збір інформації про ціль перед атакою</li>
                <li><strong>Resource Development</strong> — підготовка інфраструктури для атаки (домени, сервери, акаунти)</li>
                <li><strong>Initial Access</strong> — початкове проникнення в мережу (фішинг, експлуатація публічних сервісів)</li>
                <li><strong>Execution</strong> — виконання шкідливого коду</li>
                <li><strong>Persistence</strong> — закріплення в системі (автозапуск, заплановані завдання, імпланти)</li>
                <li><strong>Privilege Escalation</strong> — підвищення привілеїв</li>
                <li><strong>Defense Evasion</strong> — обхід засобів захисту (вимкнення антивірусу, обфускація)</li>
                <li><strong>Credential Access</strong> — отримання облікових даних (Mimikatz, keyloggers)</li>
                <li><strong>Discovery</strong> — розвідка всередині мережі (сканування, перелік ресурсів)</li>
                <li><strong>Lateral Movement</strong> — переміщення між системами в мережі (RDP, SMB, PsExec)</li>
                <li><strong>Collection</strong> — збір цільової інформації (файли, скріншоти, email)</li>
                <li><strong>Command and Control</strong> — керування скомпрометованими системами (C2-канали)</li>
                <li><strong>Exfiltration</strong> — виведення даних за межі мережі</li>
                <li><strong>Impact</strong> — деструктивні дії (шифрування, знищення, дефейс)</li>
            </ol>

            <h4>ATT&amp;CK Navigator</h4>
            <p><code>ATT&amp;CK Navigator</code> — це веб-інструмент для візуалізації покриття матриці ATT&amp;CK. Дозволяє:</p>
            <ul>
                <li><strong>Mapping покриття засобами захисту</strong> — позначити, які техніки покриті наявними засобами захисту (firewall, IDS, EDR, SIEM), та виявити прогалини</li>
                <li><strong>Mapping загроз від конкретних APT-груп</strong> — відобразити техніки, що використовуються конкретною APT-групою (наприклад, Sandworm або APT28), для пріоритезації захисту</li>
                <li><strong>Порівняння шарів (layers)</strong> — накласти кілька шарів для порівняння: наприклад, покриття детектування vs техніки конкретної загрози</li>
                <li><strong>Експорт та інтеграція</strong> — результати можна експортувати у формати JSON, Excel, SVG для включення у звіти</li>
            </ul>

<pre><code># Доступ до ATT&amp;CK Navigator:
# Онлайн: https://mitre-attack.github.io/attack-navigator/
#
# Локальне розгортання:
git clone https://github.com/mitre-attack/attack-navigator.git
cd attack-navigator/nav-app
npm install
npm start
# Відкрити http://localhost:4200</code></pre>

            <div class="info-box">
                <strong>Як використовувати ATT&amp;CK при моделюванні загроз</strong>
                1. Визначте профіль загрози для вашої ІКС (яка APT-група або тип зловмисника є найбільш релевантним). Для України актуальні: Sandworm, Gamaredon, UAC-0056.<br>
                2. Знайдіть у базі ATT&amp;CK техніки, що використовуються цим типом зловмисника.<br>
                3. Порівняйте з переліком загроз, отриманим через STRIDE — доповніть модель конкретними техніками ATT&amp;CK.<br>
                4. Використайте ATT&amp;CK Navigator для візуалізації покриття засобами захисту та виявлення прогалин.<br>
                5. Включіть ідентифікатори ATT&amp;CK (наприклад, T1566) у документацію моделі загроз.
            </div>

            <h3>6.4. Порівняння інструментів</h3>

            <table>
                <thead>
                    <tr>
                        <th>Характеристика</th>
                        <th>Microsoft TMT</th>
                        <th>OWASP Threat Dragon</th>
                        <th>MITRE ATT&amp;CK</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Тип</strong></td>
                        <td>Десктопний додаток</td>
                        <td>Веб / десктопний</td>
                        <td>База знань + Navigator</td>
                    </tr>
                    <tr>
                        <td><strong>Вартість</strong></td>
                        <td>Безкоштовно</td>
                        <td>Безкоштовно (open-source)</td>
                        <td>Безкоштовно</td>
                    </tr>
                    <tr>
                        <td><strong>Методологія</strong></td>
                        <td>STRIDE (автоматично)</td>
                        <td>STRIDE (ручне додавання)</td>
                        <td>Тактики та техніки атак</td>
                    </tr>
                    <tr>
                        <td><strong>DFD</strong></td>
                        <td>Так (вбудований редактор)</td>
                        <td>Так (вбудований редактор)</td>
                        <td>Ні</td>
                    </tr>
                    <tr>
                        <td><strong>Автоматична генерація загроз</strong></td>
                        <td>Так</td>
                        <td>Ні</td>
                        <td>Ні (але надає каталог)</td>
                    </tr>
                    <tr>
                        <td><strong>Платформа</strong></td>
                        <td>Windows</td>
                        <td>Windows, Linux, macOS</td>
                        <td>Веб (будь-яка ОС)</td>
                    </tr>
                    <tr>
                        <td><strong>Найкраще для</strong></td>
                        <td>Швидкий початковий аналіз</td>
                        <td>Командна робота, DevSecOps</td>
                        <td>Збагачення моделі реальними техніками атак</td>
                    </tr>
                </tbody>
            </table>

            <div class="warning-box">
                <strong>ATT&amp;CK — це не вичерпний перелік</strong>
                MITRE ATT&amp;CK базується на задокументованих реальних атаках. Нові техніки з'являються постійно, тому матриця регулярно оновлюється (нові версії виходять двічі на рік). ATT&amp;CK слід використовувати як доповнення до STRIDE, а не заміну — STRIDE забезпечує систематичність, а ATT&amp;CK — реалістичність моделі загроз.
            </div>

            <!-- ===== Розділ 7 ===== -->
            <h2>7. Приклад побудови моделі загроз для корпоративної мережі</h2>

            <p>Розглянемо покроковий приклад побудови моделі загроз для типової корпоративної мережі середнього підприємства (200 працівників, власна серверна кімната, віддалений доступ через VPN).</p>

            <h3>Крок 1. Опис системи та визначення меж</h3>

            <div class="example-box">
                <strong>Сценарій: IT-компанія «ТехноСофт»</strong>
                <strong>Профіль:</strong> компанія з розробки ПЗ, 200 працівників, 3 офіси в Україні.<br>
                <strong>ІКС включає:</strong><br>
                - DMZ-зона: веб-сервер (Nginx), поштовий сервер (Postfix), DNS-сервер<br>
                - LAN-зона: контролер домену (Active Directory), файловий сервер, сервер бази даних (PostgreSQL), ERP-система<br>
                - Кінцеві точки: 200 робочих станцій (Windows 10/11), 50 мобільних пристроїв<br>
                - Мережева інфраструктура: NGFW на периметрі, Core-комутатор L3, Access-комутатори L2, VPN-шлюз<br>
                - Зовнішні сервіси: Microsoft 365, AWS (хостинг продуктів), GitLab
            </div>

            <h3>Крок 2. Побудова DFD (рівень L1)</h3>
            <p>Будуємо діаграму потоків даних, визначаючи:</p>
            <ul>
                <li><strong>Зовнішні сутності:</strong> E1 — Інтернет-користувач, E2 — Віддалений працівник, E3 — Microsoft 365, E4 — AWS</li>
                <li><strong>Межі довіри:</strong> TB1 — Інтернет | DMZ, TB2 — DMZ | LAN, TB3 — LAN | Серверний сегмент</li>
                <li><strong>Процеси:</strong> P1 — Веб-сервер (Nginx), P2 — Поштовий сервер, P3 — VPN-шлюз, P4 — Active Directory, P5 — ERP-додаток</li>
                <li><strong>Сховища:</strong> D1 — БД PostgreSQL, D2 — Файловий сервер, D3 — AD-каталог, D4 — Поштові скриньки</li>
                <li><strong>Потоки:</strong> HTTPS (E1 → P1), SMTP/IMAPS (E3 → P2), WireGuard (E2 → P3), LDAP (P4 → P5), SQL (P5 → D1)</li>
            </ul>

            <h3>Крок 3. Аналіз за STRIDE</h3>
            <p>Для кожного потоку даних, що перетинає межу довіри, застосовуємо STRIDE:</p>

            <table>
                <thead>
                    <tr>
                        <th>Потік / Елемент</th>
                        <th>Категорія STRIDE</th>
                        <th>Загроза</th>
                        <th>Контрзахід</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>HTTPS (Інтернет → Веб-сервер)</td>
                        <td>Spoofing</td>
                        <td>Підробка запитів від імені легітимних користувачів</td>
                        <td>Автентифікація з MFA, CAPTCHA, rate limiting</td>
                    </tr>
                    <tr>
                        <td>HTTPS (Інтернет → Веб-сервер)</td>
                        <td>Tampering</td>
                        <td>SQL-ін'єкція, XSS через вхідні дані</td>
                        <td>WAF (ModSecurity), валідація вхідних даних, параметризовані запити</td>
                    </tr>
                    <tr>
                        <td>HTTPS (Інтернет → Веб-сервер)</td>
                        <td>DoS</td>
                        <td>DDoS-атака на веб-сервер</td>
                        <td>CDN (Cloudflare), rate limiting, anti-DDoS сервіс</td>
                    </tr>
                    <tr>
                        <td>SMTP (Інтернет → Пошта)</td>
                        <td>Spoofing</td>
                        <td>Фішингові листи від імені довірених відправників</td>
                        <td>SPF, DKIM, DMARC, антиспам-фільтри</td>
                    </tr>
                    <tr>
                        <td>SMTP (Інтернет → Пошта)</td>
                        <td>Information Disclosure</td>
                        <td>Витік конфіденційних даних через email</td>
                        <td>DLP, шифрування листів (S/MIME, PGP)</td>
                    </tr>
                    <tr>
                        <td>LDAP (AD → ERP)</td>
                        <td>Elevation of Privilege</td>
                        <td>Компрометація AD для отримання адмін-прав до ERP</td>
                        <td>Привілейований доступ (PAM), моніторинг AD, тієрінг, сегментація</td>
                    </tr>
                    <tr>
                        <td>SQL (ERP → БД)</td>
                        <td>Tampering</td>
                        <td>Несанкціонована модифікація даних у БД</td>
                        <td>Мінімальні привілеї для сервісного акаунта, аудит SQL-запитів</td>
                    </tr>
                    <tr>
                        <td>SQL (ERP → БД)</td>
                        <td>Information Disclosure</td>
                        <td>Витік даних клієнтів через компрометацію ERP</td>
                        <td>Шифрування БД (TDE), мережева сегментація, мінімальні привілеї</td>
                    </tr>
                </tbody>
            </table>

            <h3>Крок 4. Побудова моделі порушника</h3>
            <p>Для цієї організації визначаємо актуальні моделі порушника:</p>

            <table>
                <thead>
                    <tr>
                        <th>Порушник</th>
                        <th>Тип</th>
                        <th>Рівень</th>
                        <th>Мотивація</th>
                        <th>Цільові активи</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Зовнішній хакер</td>
                        <td>Зовнішній</td>
                        <td>Рівень 2</td>
                        <td>Фінансова (ransomware, продаж даних)</td>
                        <td>Дані клієнтів, облікові записи</td>
                    </tr>
                    <tr>
                        <td>APT-група (державна)</td>
                        <td>Зовнішній</td>
                        <td>Рівень 4</td>
                        <td>Шпигунство</td>
                        <td>Вихідний код, інтелектуальна власність</td>
                    </tr>
                    <tr>
                        <td>Незадоволений працівник</td>
                        <td>Внутрішній</td>
                        <td>Рівень 2</td>
                        <td>Помста, фінансова</td>
                        <td>Код, документи, дані клієнтів</td>
                    </tr>
                    <tr>
                        <td>Адміністратор-зловмисник</td>
                        <td>Внутрішній</td>
                        <td>Рівень 3</td>
                        <td>Фінансова, примус</td>
                        <td>Повний доступ до інфраструктури</td>
                    </tr>
                </tbody>
            </table>

            <h3>Крок 5. Оцінка ризиків</h3>
            <p>Для кожної ідентифікованої загрози проводимо оцінку за матрицею 5x5:</p>

            <table>
                <thead>
                    <tr>
                        <th>Загроза</th>
                        <th>Ймовірність</th>
                        <th>Вплив</th>
                        <th>Ризик</th>
                        <th>Рівень</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Фішинг → компрометація облікових даних</td>
                        <td>4</td>
                        <td>4</td>
                        <td>16</td>
                        <td>Критичний</td>
                    </tr>
                    <tr>
                        <td>Ransomware через email-вкладення</td>
                        <td>4</td>
                        <td>5</td>
                        <td>20</td>
                        <td>Критичний</td>
                    </tr>
                    <tr>
                        <td>SQL-ін'єкція у веб-додатку</td>
                        <td>3</td>
                        <td>4</td>
                        <td>12</td>
                        <td>Високий</td>
                    </tr>
                    <tr>
                        <td>Компрометація Active Directory</td>
                        <td>2</td>
                        <td>5</td>
                        <td>10</td>
                        <td>Високий</td>
                    </tr>
                    <tr>
                        <td>DDoS на веб-сервер</td>
                        <td>3</td>
                        <td>3</td>
                        <td>9</td>
                        <td>Середній</td>
                    </tr>
                    <tr>
                        <td>Витік даних через інсайдера</td>
                        <td>2</td>
                        <td>4</td>
                        <td>8</td>
                        <td>Середній</td>
                    </tr>
                </tbody>
            </table>

            <h3>Крок 6. Визначення пріоритетів та контрзаходів</h3>
            <p>На основі оцінки ризиків визначаємо пріоритети впровадження контрзаходів:</p>
            <ol>
                <li><strong>Критичні (негайно):</strong> антифішинговий захист (навчання персоналу + SPF/DKIM/DMARC + антиспам), антиransomware (EDR на всіх кінцевих точках, резервне копіювання за схемою 3-2-1, сегментація мережі, обмеження макросів)</li>
                <li><strong>Високі (протягом місяця):</strong> WAF для захисту від SQL-ін'єкцій та XSS, посилення захисту AD (PAM, моніторинг привілейованих операцій, тієрінг адміністративних акаунтів)</li>
                <li><strong>Середні (протягом кварталу):</strong> anti-DDoS захист (CDN, rate limiting), DLP-система для запобігання витокам через інсайдерів, посилення моніторингу (SIEM)</li>
            </ol>

            <div class="tip-box">
                <strong>Результат моделювання загроз</strong>
                За підсумком всіх кроків створюється документ «Модель загроз», що включає: опис ІКС та її меж, DFD (рівні L0 та L1), перелік загроз за STRIDE з прив'язкою до ATT&amp;CK, модель порушника, оцінку ризиків (матриця та/або ALE), пріоритетний перелік контрзаходів із термінами впровадження. Цей документ є основою для технічного завдання на створення КСЗІ (детально у Лекції 8).
            </div>

            <!-- ===== Підсумок ===== -->
            <h2>8. Підсумок та контрольні питання</h2>

            <p>У цій лекції ми розглянули повний цикл моделювання загроз та оцінки ризиків:</p>
            <ol>
                <li><strong>Класифікація загроз</strong> — загрози класифікуються за джерелом (природні, техногенні, антропогенні), механізмом реалізації (фізичні, програмні, організаційні) та наслідками (порушення конфіденційності, цілісності, доступності).</li>
                <li><strong>DFD (Data Flow Diagrams)</strong> — основа структурованого аналізу: візуалізація процесів, сховищ, потоків даних, зовнішніх сутностей та меж довіри. Будується ієрархічно на рівнях L0, L1, L2.</li>
                <li><strong>Методологія STRIDE</strong> — систематичний підхід до ідентифікації загроз: Spoofing, Tampering, Repudiation, Information Disclosure, DoS, Elevation of Privilege. Кожна категорія відповідає конкретній властивості безпеки.</li>
                <li><strong>Моделі порушника</strong> — визначення зовнішніх та внутрішніх порушників за 4 рівнями можливостей (від «script kiddie» до APT-груп) та типами мотивації (фінансова, ідеологічна, конкурентна, помста).</li>
                <li><strong>Оцінка ризиків</strong> — якісні (матриця 5x5 ймовірність x вплив) та кількісні (ALE = SLE x ARO) методи, а також метод DREAD для ранжування загроз за п'ятьма критеріями.</li>
                <li><strong>Інструменти</strong> — <code>Microsoft Threat Modeling Tool</code> для автоматизованого STRIDE-аналізу, <code>OWASP Threat Dragon</code> як open-source альтернатива, <code>MITRE ATT&amp;CK</code> та <code>ATT&amp;CK Navigator</code> для збагачення моделі реалістичними техніками атак.</li>
            </ol>

            <div class="tip-box">
                <strong>Контрольні питання</strong>
                1. Назвіть три класифікації загроз ІКС та наведіть по два приклади для кожної категорії.<br>
                2. Перелічіть п'ять елементів DFD та поясніть значення меж довіри (trust boundaries) для моделювання загроз.<br>
                3. Розшифруйте акронім STRIDE та поясніть кожну категорію загроз із прикладами реальних атак.<br>
                4. Побудуйте таблицю відповідності між категоріями STRIDE та властивостями безпеки (CIA). Які додаткові властивості враховує STRIDE?<br>
                5. Чим відрізняється зовнішній порушник від внутрішнього? Який з них потенційно небезпечніший і чому?<br>
                6. Опишіть 4 рівні можливостей порушника згідно з НД ТЗІ. Наведіть приклад порушника для кожного рівня.<br>
                7. Як обчислити ALE? Розрахуйте ALE для такого сценарію: вартість активу = 5 000 000 грн, фактор впливу = 10%, частота = 2 рази на рік.<br>
                8. Поясніть п'ять критеріїв методу DREAD. Як обчислюється загальний бал?<br>
                9. Порівняйте Microsoft Threat Modeling Tool та OWASP Threat Dragon. Які переваги та обмеження кожного інструменту?<br>
                10. Що таке MITRE ATT&amp;CK? Як використовувати ATT&amp;CK Navigator для аналізу покриття захисту організації?
            </div>

        </article>

        <nav class="page-nav">
            <a href="01.html">&larr; Вступ. ІКС як об'єкт захисту</a>
            <a href="03.html">Політика безпеки та доступ &rarr;</a>
        </nav>
    </main>

    <script>
        document.getElementById('menuToggle').addEventListener('click', function() {
            document.getElementById('sidebar').classList.toggle('open');
            document.getElementById('overlay').classList.toggle('active');
        });
        document.getElementById('overlay').addEventListener('click', function() {
            document.getElementById('sidebar').classList.remove('open');
            this.classList.remove('active');
        });
    </script>
</body>
</html>